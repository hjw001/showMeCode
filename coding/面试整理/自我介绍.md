1、面试官你好，我叫何佳伟，19年毕业于怀化学院通信工程，从19年三月份工作至今,前后入职两家公司担任大数据开发，目前任职于十方荣海教育科技公司数据中台部担任大数据开发岗位，在职期间主要负责公司Sass业务的数据研发，对数据仓库的建模、分层以及实施过程中的使用的HIVE调优与FLINK 流计算框架都有自己的理解，因此决定面试贵公司的大数据开发岗位，希望能够获此机会，谢谢。

离线数仓项目：
3、首先介绍下我们公司的离线数仓项目吧，这个是一直都在迭代的项目：
    3.1、当时主要是因为公司业务快速的发展，数据量也是数十倍的增长，原本支持业务数据需求的方案是 presto 写sql 进行业务逻辑开发，然后使用metabase 进行展示，由于presto是基于内存计算，每一次报表的查询都是一次新的计算，随着数据量的增长以及数据需求增加，该方案愈发乏力，主要有查询慢、查询口径不统一、重复开发等问题。因此我们决定以离线数仓的方案提供数据支持。
    3.2.1、经过讨论 我们采用的技术方案是：通过购买腾讯云EMR 集群，使用 SQOOP采集业务系统的数据到HIVE，然后使用Hive进行数据仓库的搭建，将算好的数据存在clickhouse 由后端集成到我们的CRM系统，最终将写好的脚本使用 azzkaban 凌晨定时运行，。然后我们的建模的方式是采用的Kimball维度建模，数据分层是参考的阿里的数据分层规范。
    3.2.2、我们使用SQOOP进行采集时候，会先去判断该表是维度表还是实时表，如果是维度表则全量采集，如果是事实表则根据update_time拉取前一天的数据，然后存储在ods
    3.2.3、然后通过ods的数据构建了 CRM（数据公共层），维度表放在DIM，事实表放在 DWD
    3.2.4、从ods层到dwd层时，针对缓慢变化维：我们采取的是更新策略，维度表使用全量覆盖，事实表则先判断该事实是不变化还是变化的数据，如果是不变化的数据则直接插入新分区即可，如果是变化的话则使用 历史数据 与 当日数据 进行 full join 的操作来达到 更新的策略
    3.2.5、维度建模的方式：
            第一步：针对不同部门的数据需求划分主题域，我们的数据需求主要来源于三个部门（财务、业务、投放），由于投放部门与业务部分需求基本吻合，由于财务与业务需求不一致，财务关心的是收款多少、退款多少，而业务关心的是转化，因此我们主要划分了两个主题域：财务域与业务域

            财务域主要是 做了订单的交易订单、退款订单、销售业绩归属、以及财务核算所需要的 分摊收入与预收账款等数据。

            业务域：通过主题抽象的方式，将业务划分成 全链路转化主题以及直播分析主题以及用户流失主题等
            
            全链路转化主题的主要是 处理了整个的转化流程：包括 渠道购买 -> 分配助教 ->  添加助教 -> 观看直播 ->  转化 等业务过程。
            然后按照主题划分事实表与维度表，存在dwd层

    3.2.6、然后基于dwd层的不同的主题，我们会输出一张明细宽表存在dws，主要是为了提高我们的复用与统一数据口径，基本上百分之 80的数据指标都基于这一层进行输出
    3.2.7、然后ads主要做我们的指标层，最后将计算好的指标输出到clickhouse，由后端去集成到公司的CRM后台
4、整个数仓主要解决了运营能够快速查询T-1数据、统一了数据口径与避免了重复口径的开发，提高了数据准确率以及开发效率，这就是我们的数据仓库的整个开发流程

实时项目：
5、然后再介绍下我们公司的实时数仓
    5.1、由于业务业务希望能够实时的看到转化效果，以及销售能够实时跟单未转化的用户，而现有离线数据仓库架构无法提供实时数据，因此需要搭建实时数据仓库。
    5.2、咨询了腾讯云解决方案：FLINK + CLICKHOUSE + Ocenus
    5.3、通过FLINK CDC 读取MYSQL 的数据源来构建ods
         然后 dwd层是通过ods的数据使用 temproal join的方式补全维度信息 然后sink到clickhouse，这一层主要是做了订单明细、用户到播放、用户添加好友等汇总表
         然后每5分钟通过azzkaban 进行调度，将订单、到播、添加好友等累积型的事实按照最细粒度进行汇总 补全业务宽表
         最后基于dws 的表进行指标产出
    5、4：细节自定义 source 源自定义采集新增数据

1.使用flink-cdc 对业务事实表进行增量以变化数据进行捕获搭建ods；
2.将ods进行多流join补全维度并sink到clickhouse构建dwd；
3.将dwd数据定时合并补全实时 构建dws层；
4.基于dws层数据进行指标输出
